const API_BASE="/api/xauth";async function initiateXAuth(e){try{const r=await fetch(`${API_BASE}/auth-url?avatarId=${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(404===r.status)return console.error("X auth API endpoint not found. Server may not support X integration yet."),{success:!1,error:"X integration is not available on this server."};if(!r.ok){const e=r.headers.get("content-type");let t;if(e&&e.includes("application/json"))try{t=(await r.json()).error||`Server error: ${r.status}`}catch(e){t=`Failed to parse error response: ${e.message}`}else t=`Server returned: ${r.status} ${r.statusText}`;return{success:!1,error:t}}const t=await r.json();if(t.url){const e=600,r=600,s=(window.innerWidth-e)/2,o=(window.innerHeight-r)/2,n=window.open(t.url,"xAuth",`width=${e},height=${r},top=${o},left=${s}`);return!n||n.closed||void 0===n.closed?{success:!1,error:"Popup blocked. Please allow popups for this site."}:{success:!0,popup:n}}return{success:!1,error:"No authorization URL provided by the server."}}catch(e){return console.error("Error initiating X auth:",e),{success:!1,error:e.message||"An unknown error occurred connecting to the server."}}}async function disconnectXAuth(e){try{const r=await fetch(`${API_BASE}/disconnect/${e}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(404===r.status)return console.error("X auth disconnect endpoint not found. Server may not support X integration yet."),{success:!1,error:"X integration is not available on this server."};if(!r.ok){const e=r.headers.get("content-type");let t;if(e&&e.includes("application/json"))try{t=(await r.json()).error||`Server error: ${r.status}`}catch(e){t=`Failed to parse error response: ${e.message}`}else t=`Server returned: ${r.status} ${r.statusText}`;return{success:!1,error:t}}try{return{success:!0,message:(await r.json()).message||"X account disconnected successfully."}}catch(e){return console.error("Failed to parse JSON response:",e),{success:!1,error:"Invalid response from server."}}}catch(e){return console.error("Error disconnecting X auth:",e),{success:!1,error:e.message||"An unknown error occurred connecting to the server."}}}export default{initiateXAuth,disconnectXAuth};